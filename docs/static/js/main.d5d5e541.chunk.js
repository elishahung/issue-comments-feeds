(this["webpackJsonpissue-comments-feeds"]=this["webpackJsonpissue-comments-feeds"]||[]).push([[0],{17:function(e,t,n){e.exports=n(31)},22:function(e,t,n){},23:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(5),r=n(0),c=n.n(r),o=n(6),i=n.n(o),s=(n(22),n(23),n(2)),u=n(16),m=n.n(u),d=n(3),l=Object(d.b)({name:"comments",initialState:[],reducers:{addComments:function(e,t){return[].concat(Object(a.a)(e),Object(a.a)(t.payload))}}}),f=Object(d.b)({name:"ui",initialState:{stat:"WAIT",repo:"moonshinevfx/4drec",page:1,isFetching:!1},reducers:{updateStat:function(e,t){e.stat=t.payload},increPage:function(e){e.page=e.page+1},finishPage:function(e){e.page=-1},startFetching:function(e){e.isFetching=!0},finishFetching:function(e){e.isFetching=!1}}}),h={ui:f.reducer,comments:l.reducer},g=(n(29),n(11)),p=n.n(g),b=function(e){var t=e.comment,n=p()(t.updated_at),a=(new p.a).diff(n,"days");return c.a.createElement("div",{className:"comment-feed"},c.a.createElement("div",{className:"meta"},c.a.createElement("img",{src:t.user.avatar_url,alt:"avatar"}),c.a.createElement("a",{href:t.user.html_url,target:"_blank",rel:"noopener noreferrer",className:"username"},t.user.login),c.a.createElement("span",null,"\xa0commented\xa0"),c.a.createElement("span",{className:"date"},a<3?n.fromNow():n.format("[on ]D MMM"))),c.a.createElement("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:t.body}}))},v=function(){var e=Object(s.c)((function(e){return e.comments})),t=Object(s.c)((function(e){return e.ui})),n=Object(s.b)();return c.a.createElement(m.a,{className:"comment-feed-list",pageStart:0,loadMore:function(){return n((function(e,t){e(f.actions.startFetching());var n=t().ui.repo,a={sort:"updated",direction:"desc",per_page:10,page:t().ui.page},r=new Headers,c=void 0,o="https://api.github.com/repos/".concat(n,"/issues/comments?")+"sort=".concat(a.sort,"&")+"direction=".concat(a.direction,"&")+"per_page=".concat(a.per_page,"&")+"page=".concat(a.page);fetch(o,{headers:r}).then((function(t){return 200===t.status?(e(f.actions.updateStat("DONE")),t.json()):(e(f.actions.updateStat("FAIL")),!1)})).then((function(t){if(t){if(0!==t.length){e(f.actions.increPage());var a=(c=t).map((function(e){return e.body})).join("\r\naaanewlineaaa\r\n");return fetch("https://api.github.com/markdown",{headers:r,method:"POST",body:JSON.stringify({mode:"gfm",context:n,text:a})}).then((function(e){if(e)return e.text()}))}e(f.actions.finishPage())}})).then((function(t){if(t){var n=t.split("aaanewlineaaa");c.forEach((function(e,t){var a,r;e.body=(a=n[t],r="<br>",a.startsWith(r)&&(a=a.substring(r.length)),a.endsWith(r)&&(a=a.substring(0,a.length-r.length)),a)})),e(l.actions.addComments(c))}e(f.actions.finishFetching())}))}))},hasMore:!t.isFetching&&-1!==t.page&&"FAIL"!==t.stat,threshold:1024,useWindow:!0},e.map((function(e){return c.a.createElement(b,{key:e.id,comment:e})})))},w=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(v,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(30);var E=n(4),y=[].concat(Object(a.a)(Object(d.c)()),[E.a,!1]).filter(Boolean),O=Object(d.a)({reducer:h,middleware:y});i.a.render(c.a.createElement(s.a,{store:O},c.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.d5d5e541.chunk.js.map